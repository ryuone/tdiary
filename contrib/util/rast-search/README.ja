rast-search README
===================

  Rast <http://www.netlab.jp/rast/> を用いた tDiary 検索環境です。


特徴
----------

  日記の更新と連動して自動的にインデックスを更新するので、いつでも最新の
  情報で検索することができます。日記を HTML 化した後に必要な部分だけを取
  り出してインデックスを作成するので、ヘッダやフッタなどによる検索ノイズ
  がなく、また、プラグインの出力が検索対象になるという特徴があります。


必要なもの
----------

  * tDiary 1.5 以降
  * Ruby 1.8.2 以降
  * Rast 0.0.1 以降
  * htree <http://cvs.m17n.org/~akr/htree/>


セットアップ
------------

  1. rast-search.rb を tDiary の index.rb があるディレクトリにコピーしま
     す。必要なら index.rb と同じようにシンボリックリンクを張ったり名前を
     変えたりしてください。

  2. CGI として実行可能にします。

     $ chmod a+x rast-search.rb

  3. 必要なら #! のパスを変更します。

  4. rast.rhtml と i.rast.rhtml を tDiary の skel/ ディレクトリにコピーし
     ます。

  5. rast-register.rb プラグインを有効にします。(tDiary の plugin/ ディレ
     クトリにコピーするか、プラグイン選択のディレクトリにコピーしてブラウ
     ザから有効に設定します)

  6. (オプション) tdiary.conf で以下のように encoding の設定をできます。
     Rast の encoding module の名前で設定してください。デフォルトは
     'euc_jp' です。encoding の設定を変更する場合は、Rast のインデックス
     があるディレクトリ (cache ディレクトリの下の /rast) を消して、再度イ
     ンデックスを作りなおしてください。

     @options['rast.index'] = 'utf8'

  7. tDiary の CGI の実行権限で以下のように実行して、既存の日記のインデッ
     クスを作成します。

     ruby rast-register.rb [-p tdiary.rbのあるディレクトリ] [-c tdiary.confのあるディレクトリ]

     もしくは、rast-register.rb を tDiary の index.rb があるディレクトリ
     にコピーして、 http://日記のURI/rast-register.rb にアクセスしてイン
     デックスを作成することもできます。この場合、rast-register.rb にあら
     かじめ実行属性をつけ、必要なら #! のパスを変更してください。また
     update.rb と同様のアクセス制限をかけることを推奨します。

  8. 自分の tDiary の好きな場所 (例えばヘッダ) に以下のようなフォームを加
     えてください。

     <form method="get" action="rast-search.rb" class="search">
     <input type="text" name="query" size="20" value="">
     <input type="submit" value="Search">
     </form>

     search-form.rb プラグインを有効にしている場合は、以下のように書くこ
     ともできます。

     <%= search_form('rast-search.rb', 'query') %>

  以上です。


検索のしかた
------------

  rast-search の検索対象は、日記本文、ツッコミ、TrackBack です。

  検索方法については、 http://www.netlab.jp/rast/query.html.ja をご覧くだ
  さい。


連絡先
------

  かずひこ <kazuhiko@fdiary.net>
  http://www.fdiary.net/

  バグ報告は以下のどこかにお願いします。
    * tdiary-devel ML
    * 直接メール
